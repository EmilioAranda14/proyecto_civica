version: 2

snapshots:
  - name: product_price_s_timestamp
    description: >
      Snapshot of the raw product table to historize product attributes
      and price changes over time using a timestamp strategy.

    columns:
      - name: product_id
        description: "Business key of the product used as unique identifier across versions."
        tests:
          - not_null
          - unique

      - name: _fivetran_synced
        description: "Source timestamp column used as updated_at in the snapshot strategy."

      - name: dbt_scd_id
        description: "Hash identifier for the SCD record generated by dbt."

      - name: dbt_updated_at
        description: "Timestamp when dbt detected the last change for this record."

      - name: dbt_valid_from
        description: "Timestamp when this version of the product became valid."

      - name: dbt_valid_to
        description: "Timestamp when this version of the product stopped being valid."

  - name: promos_discount_s_check
    description: >
      Snapshot of promotions to track changes in description, value and
      status over time using a check strategy.

    columns:
      - name: promo_id
        description: "Business key of the promotion used as unique identifier across versions."
        tests:
          - not_null
          - unique

      - name: promo_desc
        description: "Human-readable description of the promotion."

      - name: promo_value
        description: "Discount percentage or amount associated with the promotion."

      - name: promo_status
        description: "Status of the promotion (e.g. active, inactive, expired)."

      - name: date_load
        description: "Technical load date of the record coming from the staging layer."

      - name: dbt_scd_id
        description: "Hash identifier for the SCD record generated by dbt."

      - name: dbt_updated_at
        description: "Timestamp when dbt detected the last change for this record."

      - name: dbt_valid_from
        description: "Timestamp when this version of the promotion became valid."

      - name: dbt_valid_to
        description: "Timestamp when this version of the promotion stopped being valid."
